#let's clean the environment and load the data
rm(list=ls())
library(readxl)
#import the data from excel
data <- read_excel("/Users/mariano/Documents/01.Università/Exchange semester/Econ 664/dataset econ664.xlsx")
#let's see the data
head(data)
#let's see the structure of the data
str(data)
#let's see the summary of the data
summary(data)
#check that dates are in the right format
data$Dates <- as.Date(data$Dates, format = "%Y/%m/%d")
str(data$Dates)
#create the time series of any column
ts_000921 <- ts(data$`000921 CH Equity`, start=c(2017, 1), frequency=365)
ts_000333 <- ts(data$`000333 CH Equity`, start=c(2017, 1), frequency=365)
ts_600690 <- ts(data$`600690 CH Equity`, start=c(2017, 1), frequency=365)
#plot the time series
plot(ts_000921, main="000921 CH Equity", xlab="Time", ylab="Price", col="blue")
plot(ts_000333, main="000333 CH Equity", xlab="Time", ylab="Price", col="red")
plot(ts_600690, main="600690 CH Equity", xlab="Time", ylab="Price", col="green")
#compute the daily log returns of the price series
logret_000921 <- diff(log(ts_000921))
logret_000333 <- diff(log(ts_000333))
logret_600690 <- diff(log(ts_600690))
#plot the daily log returns
plot(logret_000921, main="000921 CH Equity", xlab="Time", ylab="Log Returns", col="blue")
plot(logret_000333, main="000333 CH Equity", xlab="Time", ylab="Log Returns", col="red")
plot(logret_600690, main="600690 CH Equity", xlab="Time", ylab="Log Returns", col="green")
#summary statistics of the daily log returns
summary(logret_000921)
summary(logret_000333)
summary(logret_600690)
#let's do the same for the other sheets of the excel file
data2 <- read_excel("/Users/mariano/Documents/01.Università/Exchange semester/Econ 664/dataset econ664.xlsx", sheet = 2)
head(data2)
str(data2)
summary(data2)
data2$Dates <- as.Date(data2$Dates, format = "%Y/%m/%d")
#let's do the same for the other sheets (AUTO) of the excel file
data2 <- read_excel("/Users/mariano/Documents/01.Università/Exchange semester/Econ 664/dataset econ664.xlsx", sheet = "AUTO")
head(data2)
str(data2)
summary(data2)
data2$Dates <- as.Date(data2$Dates, format = "%Y/%m/%d")
str(data2$Dates)
colnames(data2)
ts_3333 <- ts(data2$`3333 Equity`, start=c(2017, 1), frequency=365)
ts_1211 <- ts(data2$`1211 Equity`, start=c(2017, 1), frequency=365)
ts_1958 <- ts(data2$`1958 Equity`, start=c(2017, 1), frequency=365)
plot(ts_3333, main="3333 Equity", xlab="Time", ylab="Price", col="blue")
plot(ts_1211, main="1211 Equity", xlab="Time", ylab="Price", col="red")
plot(ts_1958, main="1958 Equity", xlab="Time", ylab="Price", col="green")
logret_3333 <- diff(log(ts_3333))
logret_1211 <- diff(log(ts_1211))
logret_1958 <- diff(log(ts_1958))
plot(logret_3333, main="3333 Equity", xlab="Time", ylab="Log Returns", col="blue")
plot(logret_1211, main="1211 Equity", xlab="Time", ylab="Log Returns", col="red")
plot(logret_1958, main="1958 Equity", xlab="Time", ylab="Log Returns", col="green")
summary(logret_3333)
summary(logret_1211)
summary(logret_1958)
#let's do the same for the other sheets (solar cells) of the excel file
data3 <- read_excel("/Users/mariano/Documents/01.Università/Exchange semester/Econ 664/dataset econ664.xlsx", sheet = "solar cells")
head(data3)
str(data3)
summary(data3)
data3$Dates <- as.Date(data3$Dates, format = "%Y/%m/%d")
str(data3$Dates)
ts_002459 <- ts(data3$`002459 Equity`, start=c(2017, 1), frequency=365)
ts_601012 <- ts(data3$`601012 Equity`, start=c(2017, 1), frequency=365)
ts_601799 <- ts(data3$`601799 Equity`, start=c(2017, 1), frequency=365)
plot(ts_002459, main="002459 Equity", xlab="Time", ylab="Price", col="blue")
plot(ts_601012, main="601012 Equity", xlab="Time", ylab="Price", col="red")
plot(ts_601799, main="601799 Equity", xlab="Time", ylab="Price", col="green")
logret_002459 <- diff(log(ts_002459))
logret_601012 <- diff(log(ts_601012))
logret_601799 <- diff(log(ts_601799))
plot(logret_002459, main="002459 Equity", xlab="Time", ylab="Log Returns", col="blue")
plot(logret_601012, main="601012 Equity", xlab="Time", ylab="Log Returns", col="red")
plot(logret_601799, main="601799 Equity", xlab="Time", ylab="Log Returns", col="green")
summary(logret_002459)
summary(logret_601012)
summary(logret_601799)
#let's do the same for the indepedent variables, sheet "Sheet6"
data4 <- read_excel("/Users/mariano/Documents/01.Università/Exchange semester/Econ 664/dataset econ664.xlsx", sheet = "Sheet6")
head(data4)
str(data4)
data5 <- read_excel("/Users/mariano/Documents/01.Università/Exchange semester/Econ 664/Book1.xlsx", sheet = "auto")
data5
head(data5)
str(data5)
summary(data5)
data5$Dates <- as.Date(data5$Dates, format = "%Y/%m/%d")
str(data5$Dates)
cap_3333 <- ts(data5$`3333 HK Equity`, start=c(2017, 1), frequency=365)
cap1211 <- ts(data5$`1211 HK Equity`, start=c(2017, 1), frequency=365)
cap1958 <- ts(data5$`1958 HK Equity`, start=c(2017, 1), frequency=365)
#let's built the auto sector index as the average of the three log returns weighted by their market capitalization
auto_index <- (logret_3333*cap_3333 + logret_1211*cap1211 + logret_1958*cap1958)/(cap_3333 + cap1211 + cap1958)
plot(auto_index, main="Auto Sector Index", xlab="Time", ylab="Log Returns", col="blue")
summary(auto_index)
#import data in the sheet "lavatrici" of the file Book1.xlsx
data6 <- read_excel("/Users/mariano/Documents/01.Università/Exchange semester/Econ 664/Book1.xlsx", sheet = "lavatrici")
head(data6)
str(data6)
summary(data6)
data6$Dates <- as.Date(data6$Dates, format = "%Y/%m/%d")
str(data6$Dates)
cap_000921 <- ts(data6$`000921 CH Equity`, start=c(2017, 1), frequency=365)
cap_000333 <- ts(data6$`000333 CH Equity`, start=c(2017, 1), frequency=365)
cap_600690 <- ts(data6$`600690 CH Equity`, start=c(2017, 1), frequency=365)
#let's built the washing machines sector index as the average of the three log returns weighted by their market capitalization
wm_index <- (logret_000921*cap_000921 + logret_000333*cap_000333 + logret_600690*cap_600690)/(cap_000921 + cap_000333 + cap_600690)
plot(wm_index, main="Washing Machines Sector Index", xlab="Time", ylab="Log Returns", col="blue")
summary(wm_index)
data7 <- read_excel("/Users/mariano/Documents/01.Università/Exchange semester/Econ 664/Book1.xlsx", sheet="solar")
head(data7)
str(data7)
summary(data7)
data7$Dates <- as.Date(data7$Dates, format = "%Y/%m/%d")
str(data7$Dates)
cap_002459 <- ts(data7$`002459 CH Equity`, start=c(2017, 1), frequency=365)
cap_601012 <- ts(data7$`601012 CH Equity`, start=c(2017, 1), frequency=365)
cap_601799 <- ts(data7$`601799 CH Equity`, start=c(2017, 1), frequency=365)
#let's built the solar cells sector index as the average of the three log returns weighted by their market capitalization
sc_index <- (logret_002459*cap_002459 + logret_601012*cap_601012 + logret_601799*cap_601799)/(cap_002459 + cap_601012 + cap_601799)
plot(sc_index, main="Solar Cells Sector Index", xlab="Time", ylab="Log Returns", col="blue")
summary(sc_index)
